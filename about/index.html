<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Peak Renewable - About Us</title>
    <!-- NOTE: Ensure the logo (1000693979.png) is in the same directory as this HTML file -->
    <link rel="icon" type="image/png" href="1000693979.png">
   <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4818572928864743"
     crossorigin="anonymous"></script> 
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googlesyndication.com/gtag/js?id=G-KMGYG29H2C"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-KMGYG29H2C');
</script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4818572928864743"
     crossorigin="anonymous"></script>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Custom font import and Tailwind configuration */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');

        :root {
            --color-primary-green: #047857;
            /* Emerald-600 */
            --color-secondary-blue: #1d4ed8;
            /* Blue-700 */
            --color-accent-yellow: #facc15;
            /* Yellow-400 */
            --font-family: 'Inter', sans-serif;
        }

        body {
            font-family: var(--font-family);
            background-color: white;
            transition: background-color 0.3s;
        }

        .text-green-peak {
            color: var(--color-primary-green);
        }

        .bg-green-peak {
            background-color: var(--color-primary-green);
        }

        .bg-blue-peak {
            background-color: var(--color-secondary-blue);
        }

        .bg-yellow-accent {
            background-color: var(--color-accent-yellow);
        }

        /* Mobile menu specific styles */
        #mobile-menu {
            transition: max-height 0.3s ease-out, opacity 0.3s ease-out;
            max-height: 0;
            overflow: hidden;
            opacity: 0;
        }

        #mobile-menu.open {
            max-height: 500px;
            /* Arbitrary large enough number */
            opacity: 1;
        }
        
        /* Style for the chat messages area */
        #advisor-messages {
            max-height: 20rem; /* Fixed height for chat window */
            height: 20rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            padding-bottom: 0.5rem;
        }

        /* Message bubble styling for responsiveness */
        .max-w-chat-bubble {
            max-width: 80%; /* Limit chat bubble width on mobile */
        }
        @media (min-width: 768px) {
             .max-w-chat-bubble {
                max-width: 75%; /* Increase width limit on desktop */
            }
        }
        
    </style>

</head>

<body class="min-h-screen flex flex-col">
    <!-- Navigation Header (MODIFIED) -->
    <header class="sticky top-0 z-50 bg-white shadow-md">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            <!-- Logo/Company Name -->
            <a href="index.html" class="flex items-center space-x-2">
                <img src="1000693979.png" alt="Peak Renewable Logo" class="w-10 h-10 rounded-full">
                <span class="text-2xl font-bold text-blue-peak">Peak Renewable</span>
            </a>

            <!-- Desktop Navigation (MODIFIED) -->
            <nav class="hidden md:flex space-x-8 font-medium">
                <a href="index.html" class="text-gray-700 hover:text-green-peak transition duration-150">Home</a>
                <a href="about.html" class="text-gray-700 hover:text-green-peak transition duration-150">About Us</a>
                <a href="services.html" class="text-gray-700 hover:text-green-peak transition duration-150">Services</a>
                <a href="product.html" class="text-gray-700 hover:text-green-peak transition duration-150">Products</a>
                <a href="articles.html" class="text-gray-700 hover:text-green-peak transition duration-150">Articles</a>
            </nav>

            <!-- Mobile Menu Button (UNCHANGED) -->
            <button id="mobile-menu-button" class="md:hidden p-2 rounded-lg text-gray-700 hover:bg-gray-100" aria-label="Toggle menu">
                <i data-lucide="menu" class="w-6 h-6"></i>
            </button>
        </div>

        <!-- Mobile Menu (MODIFIED) -->
        <nav id="mobile-menu" class="md:hidden bg-gray-50 border-t border-gray-200">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="index.html" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-gray-200 transition duration-150">Home</a>
                <a href="about.html" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-gray-200 transition duration-150">About Us</a>
                <a href="services.html" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-gray-200 transition duration-150">Services</a>
                <a href="product.html" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-gray-200 transition duration-150">Products</a>
                <a href="articles.html" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-gray-200 transition duration-150">Articles</a>
            </div>
        </nav>
    </header>

    <!-- Main Content Area -->
    <main id="content" class="flex-grow">
        
        <!-- --------------------------------- ABOUT US PAGE (UNCHANGED) --------------------------------- -->
        <section id="about" class="page-content py-12 md:py-20 bg-gray-50">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-12">
                    <h2 class="text-4xl font-extrabold text-blue-peak">About Peak Renewable</h2>
                    <p class="text-xl text-gray-600 mt-3">Powering a sustainable future for Nigeria.</p>
                </div>

                <div class="max-w-4xl mx-auto space-y-12">
                    
                    <!-- Company Overview (UNCHANGED) -->
                    <div class="bg-white p-8 rounded-xl shadow-2xl border-t-8 border-green-peak">
                        <h3 class="text-2xl font-bold text-gray-900 mb-4 flex items-center">
                            <i data-lucide="building-2" class="w-8 h-8 mr-3 text-green-peak"></i>
                            Our Company
                        </h3>
                        <p class="text-gray-700 leading-relaxed text-lg">
                            Peak Renewable is a premier sustainable energy company based in Lagos, Nigeria, specializing in high-quality solar energy solutions. We are dedicated to providing reliable, efficient, and cost-effective solar installations, maintenance services, and expert energy consultation for both residential and commercial clients. Our goal is to empower our communities with energy independence and contribute to a cleaner, more sustainable environment.
                        </p>
                    </div>

                    <!-- Mission Statement (UNCHANGED) -->
                    <div class="bg-blue-peak p-8 rounded-xl shadow-2xl text-white">
                        <h3 class="text-2xl font-bold mb-4 flex items-center">
                            <i data-lucide="rocket" class="w-8 h-8 mr-3 text-yellow-accent"></i>
                            Our Mission
                        </h3>
                        <blockquote class="text-xl md:text-2xl italic border-l-4 border-yellow-accent pl-6 leading-relaxed">
                            "To accelerate Nigeria's transition to renewable energy by delivering exceptional, reliable, and accessible solar solutions, one installation at a time."
                        </blockquote>
                    </div>

                    <!-- Customer Testimonials (UNCHANGED) -->
                    <div class="bg-white p-8 rounded-xl shadow-2xl border-t-8 border-yellow-accent">
                        <h3 class="text-2xl font-bold text-gray-900 mb-6 text-center">What Our Customers Say</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Testimonial 1 -->
                            <div class="bg-gray-50 p-6 rounded-lg shadow-inner">
                                <div class="flex items-center mb-2">
                                    <span class="w-10 h-10 rounded-full bg-blue-peak text-white flex items-center justify-center font-bold text-lg mr-3">T</span>
                                    <div>
                                        <p class="font-semibold text-gray-900">Tunde A.</p>
                                        <p class="text-sm text-gray-500">Lekki, Lagos</p>
                                    </div>
                                </div>
                                <p class="text-gray-700 italic">"Peak Renewable transformed our home. The installation was professional, and our electricity bills have dropped significantly. Highly recommend their team!"</p>
                            </div>
                            <!-- Testimonial 2 -->
                            <div class="bg-gray-50 p-6 rounded-lg shadow-inner">
                                <div class="flex items-center mb-2">
                                    <span class="w-10 h-10 rounded-full bg-green-peak text-white flex items-center justify-center font-bold text-lg mr-3">C</span>
                                    <div>
                                        <p class="font-semibold text-gray-900">Chioma E.</p>
                                        <p class="text-sm text-gray-500">Ikeja, Lagos</p>
                                    </div>
                                </div>
                                <p class="text-gray-700 italic">"The maintenance service was thorough and efficient. Their AI advisor gave me great tips even before I called them. True professionals."</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Contact Details (MODIFIED) -->
                    <div class="bg-white p-8 rounded-xl shadow-2xl border-t-8 border-blue-peak">
                        <h3 class="text-2xl font-bold text-gray-900 mb-6 text-center">Get in Touch</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- WhatsApp Button -->
                            <div class="flex items-start space-x-4">
                                <!-- SVG Icon -->
                                <div class="flex-shrink-0 w-10 h-10 p-2 bg-green-100 rounded-full flex items-center justify-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 text-green-peak">
                                        <path d="M12 0C5.373 0 0 5.373 0 12c0 2.247.604 4.341 1.768 6.136l-1.127 4.144 4.254-1.118A11.97 11.97 0 0 0 12 24c6.627 0 12-5.373 12-12C24 5.373 18.627 0 12 0zM12 22a9.982 9.982 0 0 1-5.11-.989l-.364-.216-3.79 1l1.01-3.743-.24-.383A9.998 9.998 0 0 1 12 2C6.477 2 2 6.477 2 12a9.983 9.983 0 0 0 2.63 6.64l.115.176-1.077 3.974 4.075-1.071.18.106A9.969 9.969 0 0 0 12 22zm3.3-6.42a.846.846 0 0 0-.251-.212c-.1-.055-.65-.32-.756-.358a.833.833 0 0 0-.154.025c-.097.037-.563.687-.69.832a.56.56 0 0 1-.3.26c-.15.056-.27-.015-.46-.07-.49-.15-1.896-.7-3.61-2.222a4.99 4.99 0 0 1-1.116-1.503.738.738 0 0 1 .15-.71c.07-.076.155-.18.225-.262.068-.08.136-.17.18-.25a.333.333 0 0 0 .044-.24.78.78 0 0 0-.115-.195c-.06-.115-.55-.66-.757-.89a.955.955 0 0 0-.36-.26c-.15-.054-.31-.03-.47-.03-.17 0-.35.06-.52.27-.17.21-1.11 1.07-1.11 2.607 0 1.537 1.135 2.923 1.285 3.123.15.2.29.23.56.23 1.04 0 2.93-.9 3.69-1.24a5.05 5.05 0 0 0 2.06-.678.868.868 0 0 0 .53-.88c-.02-.21-.085-.355-.16-.47z" />
                                    </svg>
                                </div>
                                <div>
                                    <p class="text-lg font-semibold text-gray-800">Chat with Us (Preferred)</p>
                                    <p class="text-gray-600 mb-2">Get an immediate response for quotes and support.</p>
                                    <a href="https://wa.me/2348087829365?text=Hello%20Peak%20Renewable,%20I%20am%20contacting%20you%20from%20your%20website." target="_blank" class="inline-flex items-center justify-center px-5 py-2.5 border border-transparent text-base font-medium rounded-lg shadow-lg transition duration-300 ease-in-out bg-green-peak text-white hover:bg-green-700">
                                        Open WhatsApp
                                    </a>
                                </div>
                            </div>

                            <!-- Email -->
                            <div class="flex items-start space-x-4">
                                <div class="flex-shrink-0 w-10 h-10 p-2 bg-blue-100 rounded-full flex items-center justify-center">
                                    <i data-lucide="mail" class="w-6 h-6 text-blue-peak"></i>
                                </div>
                                <div>
                                    <p class="text-lg font-semibold text-gray-800">Email Us</p>
                                    <p class="text-gray-600">For detailed inquiries and official communication.</p>
                                    <!-- EMAIL UPDATED HERE -->
                                    <a href="mailto:peakrenewable@gmail.com" class="text-blue-peak font-medium hover:underline text-lg">peakrenewable@gmail.com</a>
                                </div>
                            </div>
                            
                            <!-- Phone -->
                            <div class="flex items-start space-x-4">
                                <div class="flex-shrink-0 w-10 h-10 p-2 bg-yellow-100 rounded-full flex items-center justify-center">
                                    <i data-lucide="phone" class="w-6 h-6 text-yellow-600"></i>
                                </div>
                                <div>
                                    <p class="text-lg font-semibold text-gray-800">Call Us</p>
                                    <p class="text-gray-600">Speak directly with our team during business hours.</p>
                                    <a href="tel:+2348087829365" class="text-blue-peak font-medium hover:underline text-lg">+234 808 782 9365</a>
                                </div>
                            </div>

                            <!-- Address -->
                            <div class="flex items-start space-x-4">
                                <div class="flex-shrink-0 w-10 h-10 p-2 bg-gray-100 rounded-full flex items-center justify-center">
                                    <i data-lucide="map-pin" class="w-6 h-6 text-gray-600"></i>
                                </div>
                                <div>
                                    <p class="text-lg font-semibold text-gray-800">Our Office</p>
                                    <p class="text-gray-600">Lagos, Nigeria</p>
                                    <p class="text-gray-500 text-sm">(Meetings by appointment only)</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- AI Solar Advisor Section (UNCHANGED) -->
                    <!-- Logic is preserved in <script> tag -->
                    <div class="bg-blue-peak p-4 md:p-8 rounded-xl shadow-2xl">
                        <h3 class="text-3xl font-bold text-white mb-4 flex items-center justify-center">
                            <i data-lucide="bot" class="w-8 h-8 mr-3 text-yellow-accent"></i>
                            AI Solar Advisor âœ¨
                        </h3>
                        <p class="text-white opacity-80 text-center mb-6 max-w-lg mx-auto">Ask our AI any question about solar power, maintenance, or equipment sizing. Powered by Gemini's grounded search capability.</p>
                        
                        <div class="bg-white rounded-lg p-4 shadow-inner flex flex-col">
                            <!-- Message Display Area -->
                            <div id="advisor-messages" class="flex-grow overflow-y-auto space-y-4 mb-4 p-2">
                                <div class="flex justify-start">
                                    <div class="bg-green-100 text-green-800 p-3 rounded-xl rounded-bl-none max-w-chat-bubble shadow-md">
                                        Welcome! I'm the Peak Renewable AI Advisor. I can answer questions about solar energy and guide you through our services. Please note, I cannot provide pricing or product quotes, but I can refer you to our human team who will be happy to help!
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Input Form (UNCHANGED) -->
                            <form id="advisor-form" class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2 pt-2 border-t border-gray-200">
                                <input type="text" id="advisor-input" placeholder="Ask your solar question here..." required class="flex-grow p-3 border border-gray-300 rounded-lg focus:ring-green-peak focus:border-green-peak shadow-sm w-full">
                                <button type="submit" id="advisor-submit-button" class="bg-yellow-accent text-gray-900 px-4 py-3 rounded-lg font-semibold hover:bg-yellow-500 transition disabled:opacity-50 w-full sm:w-auto">
                                    Ask
                                </button>
                            </form>
                            
                            <div id="advisor-status" class="text-sm mt-2 text-gray-600 text-center"></div>
                        </div>
                    </div>

                </div>

            </div>
        </section>

    </main>

    <!-- Footer (MODIFIED) -->
    <footer class="bg-gray-900 text-white">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <!-- Company Info -->
                <div>
                    <a href="index.html" class="flex items-center space-x-2 mb-4">
                        <img src="1000693979.png" alt="Peak Renewable Logo" class="w-10 h-10 rounded-full">
                        <span class="text-2xl font-bold text-white">Peak Renewable</span>
                    </a>
                    <p class="text-gray-400">Your trusted partner in renewable energy solutions in Nigeria. Powering a sustainable future, one installation at a time.</p>
                    
                    <!-- Social Media Links (UNCHANGED) -->
                    <div class="flex space-x-4 mt-4">
                        <a href="https://www.facebook.com/profile.php?id=61571879765300" target="_blank" rel="noopener" class="text-gray-400 hover:text-white" aria-label="Peak Renewable on Facebook">
                            <i data-lucide="facebook" class="w-6 h-6"></i>
                        </a>
                        <a href="https://instagram.com/@ten_timesbetter" target="_blank" rel="noopener" class="text-gray-400 hover:text-white" aria-label="Peak Renewable on Instagram">
                            <i data-lucide="instagram" class="w-6 h-6"></i>
                        </a>
                        <a href="https://twitter.com/@tenxbio" target="_blank" rel="noopener" class="text-gray-400 hover:text-white" aria-label="Peak Renewable on Twitter/X">
                            <i data-lucide="twitter" class="w-6 h-6"></i>
                        </a>
                    </div>
                </div>

                <!-- Quick Links (MODIFIED) -->
                <div>
                    <h3 class="text-lg font-semibold mb-4">Quick Links</h3>
                    <ul class="space-y-2">
                        <li><a href="index.html" class="text-gray-400 hover:text-white transition">Home</a></li>
                        <li><a href="about.html" class="text-gray-400 hover:text-white transition">About Us</a></li>
                        <li><a href="services.html" class="text-gray-400 hover:text-white transition">Services</a></li>
                        <li><a href="product.html" class="text-gray-400 hover:text-white transition">Products</a></li>
                        <li><a href="articles.html" class="text-gray-400 hover:text-white transition">Articles</a></li>
                    </ul>
                </div>

                <!-- Services (MODIFIED) -->
                <div>
                    <h3 class="text-lg font-semibold mb-4">Our Services</h3>
                    <ul class="space-y-2">
                        <li><a href="services.html" class="text-gray-400 hover:text-white transition">Solar Installation</a></li>
                        <li><a href="services.html" class="text-gray-400 hover:text-white transition">System Maintenance</a></li>
                        <li><a href="services.html" class="text-gray-400 hover:text-white transition">Energy Consultation</a></li>
                        <li><a href="product.html" class="text-gray-400 hover:text-white transition">Product Supply</a></li>
                    </ul>
                </div>

                <!-- Contact (MODIFIED) -->
                <div>
                    <h3 class="text-lg font-semibold mb-4">Contact Us</h3>
                    <ul class="space-y-3">
                        <li class="flex items-center space-x-2">
                            <i data-lucide="map-pin" class="w-5 h-5 text-gray-400"></i>
                            <span class="text-gray-400">Lagos, Nigeria</span>
                        </li>
                        <li class="flex items-center space-x-2">
                            <i data-lucide="phone" class="w-5 h-5 text-gray-400"></i>
                            <a href="tel:+2348087829365" class="text-gray-400 hover:text-white transition">+234 808 782 9365</a>
                        </li>
                        <li class="flex items-center space-x-2">
                            <i data-lucide="mail" class="w-5 h-5 text-gray-400"></i>
                            <!-- EMAIL UPDATED HERE -->
                            <a href="mailto:peakrenewable@gmail.com" class="text-gray-400 hover:text-white transition truncate">peakrenewable@gmail.com</a>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- COPYRIGHT SECTION (MODIFIED) -->
            <div class="mt-8 border-t border-gray-700 pt-8 text-center text-gray-500">
                <p>&copy; 2024 Peak Renewable. All rights reserved. Built for a sustainable tomorrow.</p>
                <!-- NEW: Time Studio Credit -->
                <p class="mt-2 text-sm">
                    Website created by Time Studio. 
                    <a href="https://wa.me/2349116541398" target="_blank" rel="noopener" class="text-gray-400 hover:text-white underline" aria-label="Contact Time Studio on WhatsApp">
                        Contact them
                    </a>
                </p>
                <!-- END: Time Studio Credit -->
            </div>
        </div>
    </footer>

    <!-- ----------------------------------------------------------------------------------- -->
    <!-- ----------------- Custom JavaScript (MODIFIED) ----------------- -->
    <!-- ----------------------------------------------------------------------------------- -->
    <script type="module">
        // Gemini API Configuration
        const GEMINI_MODEL = 'gemini-2.5-flash-preview-09-2025';
        // Kept as empty string per instructions. The environment will provide the key.
        const GEMINI_API_KEY = "AIzaSyCRViBTVg26a5CtlEw8cYwXqepy5nfCSNM"; 

        // --- GEMINI API INTEGRATION LOGIC (UNCHANGED) ---

        /**
         * Utility function to handle the Gemini API call with exponential backoff and grounding.
         * @param {string} userQuery - The user's prompt.
         * @param {string} systemPrompt - The instruction for the model.
         * @param {number} [retryCount=0] - Current retry attempt count.
         * @returns {Promise<{text: string, sources: Array}>} - Generated text and sources.
         */
        async function geminiApiCall(userQuery, systemPrompt, retryCount = 0) {
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/${GEMINI_MODEL}:generateContent?key=${GEMINI_API_KEY}`;
            const maxRetries = 3;
            const baseDelay = 1000;

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                tools: [{ "google_search": {} }],
                systemInstruction: {
                    parts: [{ text: systemPrompt }]
                },
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    // Handle rate limiting with backoff
                    if (response.status === 429 && retryCount < maxRetries) {
                        const delay = baseDelay * Math.pow(2, retryCount);
                        // Do not log retry attempts to the console as errors
                        await new Promise(resolve => setTimeout(resolve, delay));
                        return geminiApiCall(userQuery, systemPrompt, retryCount + 1);
                    }
                    throw new Error(`API call failed with status: ${response.status}`);
                }

                const result = await response.json();
                const candidate = result.candidates?.[0];

                if (candidate && candidate.content?.parts?.[0]?.text) {
                    const text = candidate.content.parts[0].text;
                    
                    let sources = [];
                    const groundingMetadata = candidate.groundingMetadata;
                    if (groundingMetadata && groundingMetadata.groundingAttributions) {
                        sources = groundingMetadata.groundingAttributions
                            .map(attribution => ({
                                uri: attribution.web?.uri,
                                title: attribution.web?.title,
                            }))
                            .filter(source => source.uri && source.title);
                    }
                    return { text, sources };

                } else {
                    // Check for safety ratings or other reasons for no content
                    let errorMsg = "Invalid response structure from Gemini.";
                    if (result.promptFeedback) {
                        errorMsg = `Response blocked due to: ${result.promptFeedback.blockReason}`;
                    }
                    throw new Error(errorMsg);
                }

            } catch (error) {
                // Log the final error after retries
                console.error("Gemini API error after retries:", error);
                // Re-throw a generic, user-friendly error message
                throw new Error("Could not connect to the Solar Advisor. Please try again later.");
            }
        }
        
        /**
         * Handles the submission of the AI Solar Advisor form.
         */
        async function handleAdvisorSubmit(event) {
            event.preventDefault();
            
            const inputEl = document.getElementById('advisor-input');
            const messagesEl = document.getElementById('advisor-messages');
            const statusEl = document.getElementById('advisor-status');
            const submitBtn = document.getElementById('advisor-submit-button');
            
            const userQuery = inputEl.value.trim();
            if (!userQuery) return;
            
            submitBtn.disabled = true;
            inputEl.value = ''; // Clear input immediately
            statusEl.textContent = '';
            
            // Display user message
            messagesEl.innerHTML += `
                <div class="flex justify-end">
                    <div class="bg-blue-200 text-gray-900 p-3 rounded-xl rounded-br-none max-w-chat-bubble shadow-md">
                        ${userQuery.replace(/</g, "&lt;").replace(/>/g, "&gt;")}
                    </div>
                </div>
            `;
            messagesEl.scrollTop = messagesEl.scrollHeight;
            
            // Display loading message
            const loadingMessageId = `loading-${Date.now()}`;
            messagesEl.innerHTML += `
                <div class="flex justify-start" id="${loadingMessageId}">
                    <div class="bg-gray-100 text-gray-600 p-3 rounded-xl rounded-bl-none max-w-chat-bubble shadow-md animate-pulse">
                        Thinking... (I will reply shortly)
                    </div>
                </div>
            `;
            messagesEl.scrollTop = messagesEl.scrollHeight;

            try {
                statusEl.textContent = 'Searching the web for current, grounded advice...';
                
                const systemPrompt = "You are the Peak Renewable AI Advisor. Your role is to be polite, helpful, and straightforward. Your goal is to guide customers and provide information about renewable energy. You MUST NOT, under any circumstances, mention prices, costs, or any amount of money. If a user asks about pricing, products, or installation quotes, you MUST politely refer them to the human assistance team via the WhatsApp or Email links on the website.";

                const { text, sources } = await geminiApiCall(userQuery, systemPrompt);
                
                // Remove loading message
                document.getElementById(loadingMessageId).remove();
                
                // Construct the full response message with sources
                let sourceHtml = '';
                if (sources.length > 0) {
                    sourceHtml = `<div class="mt-2 pt-2 border-t border-green-300 text-xs text-green-800 opacity-80">
                        <p class="font-semibold mb-1">Sources consulted:</p>
                        <ul class="list-disc pl-5 space-y-0.5">
                            ${sources.map((s, index) => `<li><a href="${s.uri}" target="_blank" class="hover:underline text-blue-peak font-medium">${s.title}</a></li>`).join('')}
                        </ul>
                    </div>`;
                }
                
                // Display AI response
                messagesEl.innerHTML += `
                    <div class="flex justify-start">
                        <div class="bg-green-100 text-green-800 p-3 rounded-xl rounded-bl-none max-w-chat-bubble shadow-md">
                            ${text.replace(/\n/g, '<br>')}
                            ${sourceHtml}
                        </div>
                    </div>
                `;
                messagesEl.scrollTop = messagesEl.scrollHeight;
                statusEl.textContent = 'Response ready.';

            } catch (error) {
                // Remove loading message
                document.getElementById(loadingMessageId)?.remove();
                
                // Display error message
                messagesEl.innerHTML += `
                    <div class="flex justify-start">
                        <div class="bg-red-100 text-red-700 p-3 rounded-xl rounded-bl-none max-w-chat-bubble shadow-md">
                            System Error: ${error.message}
                        </div>
                    </div>
                `;
                messagesEl.scrollTop = messagesEl.scrollHeight;
                statusEl.textContent = 'Error: Failed to get advice.';

            } finally {
                submitBtn.disabled = false;
            }
        }

        /**
         * Initializes all event listeners for static content and new features.
         */
        function initializeEventListeners() {
            // Mobile menu toggle
            const menuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            
            if (menuButton && mobileMenu) {
                menuButton.addEventListener('click', () => {
                    const isOpen = mobileMenu.classList.toggle('open');
                    if (isOpen) {
                        menuButton.innerHTML = `<i data-lucide="x" class="w-6 h-6"></i>`;
                    } else {
                        menuButton.innerHTML = `<i data-lucide="menu" class="w-6 h-6"></i>`;
                    }
                    lucide.createIcons();
                });
            }
            
            // AI Solar Advisor Form Submission
            document.getElementById('advisor-form')?.addEventListener('submit', handleAdvisorSubmit);
        }
        
        // Initial setup on DOM content loaded
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize Lucide icons
            lucide.createIcons();
            
            // Setup event listeners
            initializeEventListeners();
        });

    </script>
</body>
    </html>
